
syntax = "proto3";

package inference;

service InferenceService {
  rpc Predict (PredictRequest) returns (PredictResponse) {}
  rpc BatchPredict (BatchPredictRequest) returns (BatchPredictResponse) {}
  rpc TestPredict (TestPredictRequest) returns (TestPredictResponse) {}
}

message PredictRequest {
  bytes image_data = 1;
}

message PredictResponse {
  repeated Detection detections = 1;
}

message BatchPredictRequest {
  repeated bytes image_data = 1;
}

message BatchPredictResponse {
  repeated PredictResponse results = 1;
}

message TestPredictRequest {
  bytes image_data = 1;
}

message TestPredictResponse {
  repeated Detection detections = 1;
  string orig_shape = 2;
  string boxes = 3;
  string probs = 4;
  string keypoints = 5;
  string obb = 6;
  string speed = 7;
  string names = 8;
  string json_output = 9;
  bytes plot_image = 10;
  string verbose_output = 11;
}

message Detection {
  string label = 1;
  float confidence = 2;
  repeated float bbox = 3;
}